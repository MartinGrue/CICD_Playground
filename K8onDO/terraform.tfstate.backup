{
  "version": 4,
  "terraform_version": "0.14.7",
  "serial": 1475,
  "lineage": "d4a932c1-2d85-104f-3849-98a5cb6a13ad",
  "outputs": {},
  "resources": [
    {
      "module": "module.etcd",
      "mode": "data",
      "type": "null_data_source",
      "name": "endpoints",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "has_computed_default": "default",
            "id": "static",
            "inputs": {
              "list": "http://10.0.1.1:2379,http://10.0.1.2:2379,http://10.0.1.3:2379"
            },
            "outputs": {
              "list": "http://10.0.1.1:2379,http://10.0.1.2:2379,http://10.0.1.3:2379"
            },
            "random": "7777497311235100133"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.etcd",
      "mode": "data",
      "type": "template_file",
      "name": "etcd-service",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "d12184bb231f3afaa43210456025f4f4a14e817332667fea42c50f0342b9973b",
            "rendered": "[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube1 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.1:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.1:2379\" \\\n  --listen-peer-urls \"http://10.0.1.1:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.1:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target",
            "template": "[Unit]\nDescription=etcd\nAfter=network.target ${vpn_unit}\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name ${hostname} \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"${listen_client_urls},http://localhost:2379\" \\\n  --advertise-client-urls \"${advertise_client_urls}\" \\\n  --listen-peer-urls \"${listen_peer_urls}\" \\\n  --initial-cluster \"${intial_cluster}\" \\\n  --initial-advertise-peer-urls \"${listen_peer_urls}\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target",
            "vars": {
              "advertise_client_urls": "http://10.0.1.1:2379",
              "hostname": "kube1",
              "intial_cluster": "kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380",
              "listen_client_urls": "http://10.0.1.1:2379",
              "listen_peer_urls": "http://10.0.1.1:2380",
              "vpn_unit": "wg-quick@wg0.service"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "d70af184c0627b6c8f14e5937da0e16defdcf544bd51c5e6c162dd3f125c8084",
            "rendered": "[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube2 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.2:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.2:2379\" \\\n  --listen-peer-urls \"http://10.0.1.2:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.2:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target",
            "template": "[Unit]\nDescription=etcd\nAfter=network.target ${vpn_unit}\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name ${hostname} \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"${listen_client_urls},http://localhost:2379\" \\\n  --advertise-client-urls \"${advertise_client_urls}\" \\\n  --listen-peer-urls \"${listen_peer_urls}\" \\\n  --initial-cluster \"${intial_cluster}\" \\\n  --initial-advertise-peer-urls \"${listen_peer_urls}\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target",
            "vars": {
              "advertise_client_urls": "http://10.0.1.2:2379",
              "hostname": "kube2",
              "intial_cluster": "kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380",
              "listen_client_urls": "http://10.0.1.2:2379",
              "listen_peer_urls": "http://10.0.1.2:2380",
              "vpn_unit": "wg-quick@wg0.service"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "ed8f153ee5b2f1406c5354889ab46353a584ec96adb433dbdbdd2fd706cc61e8",
            "rendered": "[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube3 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.3:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.3:2379\" \\\n  --listen-peer-urls \"http://10.0.1.3:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.3:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target",
            "template": "[Unit]\nDescription=etcd\nAfter=network.target ${vpn_unit}\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name ${hostname} \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"${listen_client_urls},http://localhost:2379\" \\\n  --advertise-client-urls \"${advertise_client_urls}\" \\\n  --listen-peer-urls \"${listen_peer_urls}\" \\\n  --initial-cluster \"${intial_cluster}\" \\\n  --initial-advertise-peer-urls \"${listen_peer_urls}\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target",
            "vars": {
              "advertise_client_urls": "http://10.0.1.3:2379",
              "hostname": "kube3",
              "intial_cluster": "kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380",
              "listen_client_urls": "http://10.0.1.3:2379",
              "listen_peer_urls": "http://10.0.1.3:2380",
              "vpn_unit": "wg-quick@wg0.service"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.etcd",
      "mode": "data",
      "type": "template_file",
      "name": "install",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "9d9e8ec92ad9a9dcae75ebd21af186fa0687540a54537b02861ece3be36ce87b",
            "rendered": "#!/bin/sh\nset -e\n\nrm -f /opt/etcd-v3.4.13-linux-amd64.tar.gz\nrm -rf /opt/etcd \u0026\u0026 mkdir -p /opt/etcd\n\ncurl -L https://storage.googleapis.com/etcd/v3.4.13/etcd-v3.4.13-linux-amd64.tar.gz \\\n  -o /opt/etcd-v3.4.13-linux-amd64.tar.gz\ntar xzvf /opt/etcd-v3.4.13-linux-amd64.tar.gz -C /opt/etcd --strip-components=1",
            "template": "#!/bin/sh\nset -e\n\nrm -f /opt/etcd-${version}-linux-amd64.tar.gz\nrm -rf /opt/etcd \u0026\u0026 mkdir -p /opt/etcd\n\ncurl -L https://storage.googleapis.com/etcd/${version}/etcd-${version}-linux-amd64.tar.gz \\\n  -o /opt/etcd-${version}-linux-amd64.tar.gz\ntar xzvf /opt/etcd-${version}-linux-amd64.tar.gz -C /opt/etcd --strip-components=1",
            "vars": {
              "version": "v3.4.13"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.etcd",
      "mode": "managed",
      "type": "null_resource",
      "name": "etcd",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "7403991749700323032",
            "triggers": {
              "template": "[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube1 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.1:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.1:2379\" \\\n  --listen-peer-urls \"http://10.0.1.1:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.1:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube2 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.2:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.2:2379\" \\\n  --listen-peer-urls \"http://10.0.1.2:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.2:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube3 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.3:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.3:2379\" \\\n  --listen-peer-urls \"http://10.0.1.3:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.3:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.etcd.data.template_file.etcd-service",
            "module.etcd.data.template_file.install",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "id": "5478926632627273589",
            "triggers": {
              "template": "[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube1 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.1:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.1:2379\" \\\n  --listen-peer-urls \"http://10.0.1.1:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.1:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube2 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.2:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.2:2379\" \\\n  --listen-peer-urls \"http://10.0.1.2:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.2:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube3 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.3:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.3:2379\" \\\n  --listen-peer-urls \"http://10.0.1.3:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.3:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.etcd.data.template_file.etcd-service",
            "module.etcd.data.template_file.install",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "id": "5500379602795625533",
            "triggers": {
              "template": "[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube1 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.1:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.1:2379\" \\\n  --listen-peer-urls \"http://10.0.1.1:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.1:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube2 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.2:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.2:2379\" \\\n  --listen-peer-urls \"http://10.0.1.2:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.2:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target[Unit]\nDescription=etcd\nAfter=network.target wg-quick@wg0.service\n\n[Service]\nType=notify\nExecStart=/opt/etcd/etcd --name kube3 \\\n  --data-dir /var/lib/etcd \\\n  --listen-client-urls \"http://10.0.1.3:2379,http://localhost:2379\" \\\n  --advertise-client-urls \"http://10.0.1.3:2379\" \\\n  --listen-peer-urls \"http://10.0.1.3:2380\" \\\n  --initial-cluster \"kube1=http://10.0.1.1:2380,kube2=http://10.0.1.2:2380,kube3=http://10.0.1.3:2380\" \\\n  --initial-advertise-peer-urls \"http://10.0.1.3:2380\" \\\n  --heartbeat-interval 200 \\\n  --election-timeout 5000\nRestart=always\nRestartSec=5\nTimeoutStartSec=0\nStartLimitInterval=0\n\n[Install]\nWantedBy=multi-user.target"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.etcd.data.template_file.etcd-service",
            "module.etcd.data.template_file.install",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        }
      ]
    },
    {
      "module": "module.firewall",
      "mode": "data",
      "type": "template_file",
      "name": "ufw",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "220a183214152e16440d7d808b7a43ddc552db29b2a15973f9f7f78267149643",
            "rendered": "#!/bin/sh\nset -e\n\nufw --force reset\nufw allow ssh\nufw allow in on eth1 to any port 51820 # vpn on private interface\nufw allow in on wg0\nufw allow in on weave # Kubernetes pod overlay interface\nufw allow 6443 # Kubernetes API secure remote port\nufw allow 80\nufw allow 443\n\nufw default deny incoming\nufw --force enable\nufw status verbose",
            "template": "#!/bin/sh\nset -e\n\nufw --force reset\nufw allow ssh\nufw allow in on ${private_interface} to any port ${vpn_port} # vpn on private interface\nufw allow in on ${vpn_interface}\nufw allow in on ${kubernetes_interface} # Kubernetes pod overlay interface\nufw allow 6443 # Kubernetes API secure remote port\nufw allow 80\nufw allow 443\n${additional_rules}\nufw default deny incoming\nufw --force enable\nufw status verbose",
            "vars": {
              "additional_rules": "",
              "kubernetes_interface": "weave",
              "private_interface": "eth1",
              "vpn_interface": "wg0",
              "vpn_port": "51820"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.firewall",
      "mode": "managed",
      "type": "null_resource",
      "name": "firewall",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "5567467976229301993",
            "triggers": {
              "template": "#!/bin/sh\nset -e\n\nufw --force reset\nufw allow ssh\nufw allow in on eth1 to any port 51820 # vpn on private interface\nufw allow in on wg0\nufw allow in on weave # Kubernetes pod overlay interface\nufw allow 6443 # Kubernetes API secure remote port\nufw allow 80\nufw allow 443\n\nufw default deny incoming\nufw --force enable\nufw status verbose"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.firewall.data.template_file.ufw",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "id": "7139654486558019029",
            "triggers": {
              "template": "#!/bin/sh\nset -e\n\nufw --force reset\nufw allow ssh\nufw allow in on eth1 to any port 51820 # vpn on private interface\nufw allow in on wg0\nufw allow in on weave # Kubernetes pod overlay interface\nufw allow 6443 # Kubernetes API secure remote port\nufw allow 80\nufw allow 443\n\nufw default deny incoming\nufw --force enable\nufw status verbose"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.firewall.data.template_file.ufw",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "id": "2000076891518934602",
            "triggers": {
              "template": "#!/bin/sh\nset -e\n\nufw --force reset\nufw allow ssh\nufw allow in on eth1 to any port 51820 # vpn on private interface\nufw allow in on wg0\nufw allow in on weave # Kubernetes pod overlay interface\nufw allow 6443 # Kubernetes API secure remote port\nufw allow 80\nufw allow 443\n\nufw default deny incoming\nufw --force enable\nufw status verbose"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.firewall.data.template_file.ufw",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "data",
      "type": "template_file",
      "name": "install",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "ed267a95dc6feb90e0fdab1f055341680cba950815c5d7741ff3beb15a72ef30",
            "rendered": "#!/bin/sh\nset -e\n\ncurl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -\ncat \u003c\u003cEOF \u003e /etc/apt/sources.list.d/kubernetes.list\ndeb http://apt.kubernetes.io/ kubernetes-xenial-unstable main\nEOF\napt-get update\napt-get install -y docker.io\napt-get install -y kubelet kubeadm kubectl kubernetes-cni",
            "template": "#!/bin/sh\nset -e\n\ncurl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -\ncat \u003c\u003cEOF \u003e /etc/apt/sources.list.d/kubernetes.list\ndeb http://apt.kubernetes.io/ kubernetes-xenial-unstable main\nEOF\napt-get update\napt-get install -y docker.io\napt-get install -y kubelet kubeadm kubectl kubernetes-cni",
            "vars": {
              "overlay_cidr": "10.96.0.0/16",
              "vpn_interface": "wg0"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "ed267a95dc6feb90e0fdab1f055341680cba950815c5d7741ff3beb15a72ef30",
            "rendered": "#!/bin/sh\nset -e\n\ncurl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -\ncat \u003c\u003cEOF \u003e /etc/apt/sources.list.d/kubernetes.list\ndeb http://apt.kubernetes.io/ kubernetes-xenial-unstable main\nEOF\napt-get update\napt-get install -y docker.io\napt-get install -y kubelet kubeadm kubectl kubernetes-cni",
            "template": "#!/bin/sh\nset -e\n\ncurl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -\ncat \u003c\u003cEOF \u003e /etc/apt/sources.list.d/kubernetes.list\ndeb http://apt.kubernetes.io/ kubernetes-xenial-unstable main\nEOF\napt-get update\napt-get install -y docker.io\napt-get install -y kubelet kubeadm kubectl kubernetes-cni",
            "vars": {
              "overlay_cidr": "10.96.0.0/16",
              "vpn_interface": "wg0"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "ed267a95dc6feb90e0fdab1f055341680cba950815c5d7741ff3beb15a72ef30",
            "rendered": "#!/bin/sh\nset -e\n\ncurl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -\ncat \u003c\u003cEOF \u003e /etc/apt/sources.list.d/kubernetes.list\ndeb http://apt.kubernetes.io/ kubernetes-xenial-unstable main\nEOF\napt-get update\napt-get install -y docker.io\napt-get install -y kubelet kubeadm kubectl kubernetes-cni",
            "template": "#!/bin/sh\nset -e\n\ncurl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -\ncat \u003c\u003cEOF \u003e /etc/apt/sources.list.d/kubernetes.list\ndeb http://apt.kubernetes.io/ kubernetes-xenial-unstable main\nEOF\napt-get update\napt-get install -y docker.io\napt-get install -y kubelet kubeadm kubectl kubernetes-cni",
            "vars": {
              "overlay_cidr": "10.96.0.0/16",
              "vpn_interface": "wg0"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "data",
      "type": "template_file",
      "name": "master",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "0c410257d731fce52fbc5a410c7a2109b0a8638c0955954ca069ce61bc639c7f",
            "rendered": "#!/bin/sh\nset -e\n\nkubeadm init --config /tmp/master-configuration.yml \\\n  --ignore-preflight-errors=Swap,NumCPU\n\nkubeadm token create woc4tf.w2qpjehg1gekioxp\n\n[ -d $HOME/.kube ] || mkdir -p $HOME/.kube\nln -s /etc/kubernetes/admin.conf $HOME/.kube/config\n\nuntil nc -z localhost 6443; do\n  echo \"Waiting for API server to respond\"\n  sleep 5\ndone\n\nkubectl apply -f \"https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\\n')\"\n\n# See: https://kubernetes.io/docs/admin/authorization/rbac/\nkubectl create clusterrolebinding permissive-binding \\\n  --clusterrole=cluster-admin \\\n  --user=admin \\\n  --user=kubelet \\\n  --group=system:serviceaccounts",
            "template": "#!/bin/sh\nset -e\n\nkubeadm init --config /tmp/master-configuration.yml \\\n  --ignore-preflight-errors=Swap,NumCPU\n\nkubeadm token create ${token}\n\n[ -d $HOME/.kube ] || mkdir -p $HOME/.kube\nln -s /etc/kubernetes/admin.conf $HOME/.kube/config\n\nuntil nc -z localhost 6443; do\n  echo \"Waiting for API server to respond\"\n  sleep 5\ndone\n\nkubectl apply -f \"https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\\n')\"\n\n# See: https://kubernetes.io/docs/admin/authorization/rbac/\nkubectl create clusterrolebinding permissive-binding \\\n  --clusterrole=cluster-admin \\\n  --user=admin \\\n  --user=kubelet \\\n  --group=system:serviceaccounts",
            "vars": {
              "token": "woc4tf.w2qpjehg1gekioxp"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "data",
      "type": "template_file",
      "name": "master-configuration",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "bb4097beedaf663453e8cfbb3e7297ce21a981971922489c73ed53d6969d515b",
            "rendered": "\napiVersion: kubeadm.k8s.io/v1beta2\nkind: InitConfiguration\nlocalAPIEndpoint:\n  advertiseAddress: 10.0.1.1\n  bindPort: 6443\n---\napiVersion: kubeadm.k8s.io/v1beta2\nkind: ClusterConfiguration\ncertificatesDir: /etc/kubernetes/pki\napiServer:\n  certSANs:\n  - 46.101.167.204\netcd:\n  external:\n    endpoints:\n    - http://10.0.1.1:2379\n    - http://10.0.1.2:2379\n    - http://10.0.1.3:2379\n---\napiVersion: kubelet.config.k8s.io/v1beta1\nkind: KubeletConfiguration\nfailSwapOn: false",
            "template": "\napiVersion: kubeadm.k8s.io/v1beta2\nkind: InitConfiguration\nlocalAPIEndpoint:\n  advertiseAddress: ${api_advertise_addresses}\n  bindPort: 6443\n---\napiVersion: kubeadm.k8s.io/v1beta2\nkind: ClusterConfiguration\ncertificatesDir: /etc/kubernetes/pki\napiServer:\n  certSANs:\n  ${cert_sans}\netcd:\n  external:\n    endpoints:\n    ${etcd_endpoints}\n---\napiVersion: kubelet.config.k8s.io/v1beta1\nkind: KubeletConfiguration\nfailSwapOn: false",
            "vars": {
              "api_advertise_addresses": "10.0.1.1",
              "cert_sans": "- 46.101.167.204",
              "etcd_endpoints": "- http://10.0.1.1:2379\n    - http://10.0.1.2:2379\n    - http://10.0.1.3:2379"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "data",
      "type": "template_file",
      "name": "slave",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "e3b15228b8b30950ea0c57cc95a8b50094fc7d410c350c9febb127810007068b",
            "rendered": "\n#!/bin/sh\nset -e\n\nuntil $(nc -z 10.0.1.1 6443); do\n  echo \"Waiting for API server to respond\"\n  sleep 5\ndone\n\nkubeadm join --token=woc4tf.w2qpjehg1gekioxp 10.0.1.1:6443 \\\n  --discovery-token-unsafe-skip-ca-verification \\\n  --ignore-preflight-errors=Swap",
            "template": "\n#!/bin/sh\nset -e\n\nuntil $(nc -z ${master_ip} 6443); do\n  echo \"Waiting for API server to respond\"\n  sleep 5\ndone\n\nkubeadm join --token=${token} ${master_ip}:6443 \\\n  --discovery-token-unsafe-skip-ca-verification \\\n  --ignore-preflight-errors=Swap",
            "vars": {
              "master_ip": "10.0.1.1",
              "token": "woc4tf.w2qpjehg1gekioxp"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "managed",
      "type": "null_resource",
      "name": "kubectl",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "5852316003949103075",
            "triggers": {
              "ip": "10.0.1.1"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.etcd.data.null_data_source.endpoints",
            "module.etcd.data.template_file.etcd-service",
            "module.etcd.data.template_file.install",
            "module.etcd.null_resource.etcd",
            "module.kubernetes.data.template_file.install",
            "module.kubernetes.data.template_file.master",
            "module.kubernetes.data.template_file.master-configuration",
            "module.kubernetes.data.template_file.slave",
            "module.kubernetes.null_resource.kubernetes",
            "module.kubernetes.random_string.token1",
            "module.kubernetes.random_string.token2",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host",
            "module.wireguard.data.external.keys",
            "module.wireguard.data.template_file.interface-conf",
            "module.wireguard.data.template_file.overlay-route-service",
            "module.wireguard.data.template_file.peer-conf",
            "module.wireguard.data.template_file.vpn_ips",
            "module.wireguard.null_resource.wireguard"
          ]
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "managed",
      "type": "null_resource",
      "name": "kubernetes",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "6435498790699709464",
            "triggers": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.etcd.data.null_data_source.endpoints",
            "module.etcd.data.template_file.etcd-service",
            "module.etcd.data.template_file.install",
            "module.etcd.null_resource.etcd",
            "module.kubernetes.data.template_file.install",
            "module.kubernetes.data.template_file.master",
            "module.kubernetes.data.template_file.master-configuration",
            "module.kubernetes.data.template_file.slave",
            "module.kubernetes.random_string.token1",
            "module.kubernetes.random_string.token2",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host",
            "module.wireguard.data.external.keys",
            "module.wireguard.data.template_file.interface-conf",
            "module.wireguard.data.template_file.overlay-route-service",
            "module.wireguard.data.template_file.peer-conf",
            "module.wireguard.data.template_file.vpn_ips",
            "module.wireguard.null_resource.wireguard"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "id": "1410178272661479533",
            "triggers": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.etcd.data.null_data_source.endpoints",
            "module.etcd.data.template_file.etcd-service",
            "module.etcd.data.template_file.install",
            "module.etcd.null_resource.etcd",
            "module.kubernetes.data.template_file.install",
            "module.kubernetes.data.template_file.master",
            "module.kubernetes.data.template_file.master-configuration",
            "module.kubernetes.data.template_file.slave",
            "module.kubernetes.random_string.token1",
            "module.kubernetes.random_string.token2",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host",
            "module.wireguard.data.external.keys",
            "module.wireguard.data.template_file.interface-conf",
            "module.wireguard.data.template_file.overlay-route-service",
            "module.wireguard.data.template_file.peer-conf",
            "module.wireguard.data.template_file.vpn_ips",
            "module.wireguard.null_resource.wireguard"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "id": "3258056275740436186",
            "triggers": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.etcd.data.null_data_source.endpoints",
            "module.etcd.data.template_file.etcd-service",
            "module.etcd.data.template_file.install",
            "module.etcd.null_resource.etcd",
            "module.kubernetes.data.template_file.install",
            "module.kubernetes.data.template_file.master",
            "module.kubernetes.data.template_file.master-configuration",
            "module.kubernetes.data.template_file.slave",
            "module.kubernetes.random_string.token1",
            "module.kubernetes.random_string.token2",
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host",
            "module.wireguard.data.external.keys",
            "module.wireguard.data.template_file.interface-conf",
            "module.wireguard.data.template_file.overlay-route-service",
            "module.wireguard.data.template_file.peer-conf",
            "module.wireguard.data.template_file.vpn_ips",
            "module.wireguard.null_resource.wireguard"
          ]
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "managed",
      "type": "random_string",
      "name": "token1",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "woc4tf",
            "keepers": null,
            "length": 6,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "override_special": null,
            "result": "woc4tf",
            "special": false,
            "upper": false
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "module": "module.kubernetes",
      "mode": "managed",
      "type": "random_string",
      "name": "token2",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "w2qpjehg1gekioxp",
            "keepers": null,
            "length": 16,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "override_special": null,
            "result": "w2qpjehg1gekioxp",
            "special": false,
            "upper": false
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "module": "module.provider",
      "mode": "data",
      "type": "digitalocean_ssh_key",
      "name": "main",
      "provider": "module.provider.provider[\"registry.terraform.io/digitalocean/digitalocean\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "fingerprint": "84:bb:ef:43:ca:9d:99:12:2e:f4:b2:42:ea:94:bc:1c",
            "id": "29563729",
            "name": "gruma-key",
            "public_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDE6hCBwOmSn0qbPk9sl0k7sjjryNHHdp808EUALPsneBlmX29Y7KpjboX3a7tkgqNNqSRcp7hUHgLviSyyV4yDXdnhWq+I8wqRBDcagzVoezXI2n/KZ81lFhqf/7quS/NzaqhENwYw9WkQ6/htY+aDUvkgtRBNai1c7q2mzf4V3qIkOnGT1mZEJLfRodrBPbmleRMH+yTgJUWPetxG/wYEdgCC0bOkWsjYNnKNbee1OAFWE/sZYYyBNGGYgK+tMq+/SdVTFWQN1d6ald7IeXhno4N/DkiUGokdI8WDeL/sfQvUWQq2LPRM6nm+CLJAgkk52uwKBNs9a5RE5LZmhYZH gruma@gruma-pc"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.provider",
      "mode": "managed",
      "type": "digitalocean_droplet",
      "name": "host",
      "provider": "module.provider.provider[\"registry.terraform.io/digitalocean/digitalocean\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "backups": false,
            "created_at": "2021-03-01T19:18:39Z",
            "disk": 50,
            "id": "234405353",
            "image": "ubuntu-20-04-x64",
            "ipv4_address": "46.101.167.204",
            "ipv4_address_private": "10.114.0.3",
            "ipv6": false,
            "ipv6_address": "",
            "ipv6_address_private": null,
            "locked": false,
            "memory": 2048,
            "monitoring": false,
            "name": "kube1",
            "price_hourly": 0.01488,
            "price_monthly": 10,
            "private_networking": true,
            "region": "fra1",
            "resize_disk": true,
            "size": "s-1vcpu-2gb",
            "ssh_keys": [
              "29563729"
            ],
            "status": "active",
            "tags": null,
            "urn": "do:droplet:234405353",
            "user_data": null,
            "vcpus": 1,
            "volume_ids": [],
            "vpc_uuid": "dbd7e3b0-6628-4e50-b8a3-fb90ccf9bd77"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 1,
          "attributes": {
            "backups": false,
            "created_at": "2021-03-01T19:18:39Z",
            "disk": 50,
            "id": "234405354",
            "image": "ubuntu-20-04-x64",
            "ipv4_address": "46.101.133.187",
            "ipv4_address_private": "10.114.0.2",
            "ipv6": false,
            "ipv6_address": "",
            "ipv6_address_private": null,
            "locked": false,
            "memory": 2048,
            "monitoring": false,
            "name": "kube2",
            "price_hourly": 0.01488,
            "price_monthly": 10,
            "private_networking": true,
            "region": "fra1",
            "resize_disk": true,
            "size": "s-1vcpu-2gb",
            "ssh_keys": [
              "29563729"
            ],
            "status": "active",
            "tags": null,
            "urn": "do:droplet:234405354",
            "user_data": null,
            "vcpus": 1,
            "volume_ids": [],
            "vpc_uuid": "dbd7e3b0-6628-4e50-b8a3-fb90ccf9bd77"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 1,
          "attributes": {
            "backups": false,
            "created_at": "2021-03-01T19:18:39Z",
            "disk": 50,
            "id": "234405355",
            "image": "ubuntu-20-04-x64",
            "ipv4_address": "159.89.4.21",
            "ipv4_address_private": "10.114.0.4",
            "ipv6": false,
            "ipv6_address": "",
            "ipv6_address_private": null,
            "locked": false,
            "memory": 2048,
            "monitoring": false,
            "name": "kube3",
            "price_hourly": 0.01488,
            "price_monthly": 10,
            "private_networking": true,
            "region": "fra1",
            "resize_disk": true,
            "size": "s-1vcpu-2gb",
            "ssh_keys": [
              "29563729"
            ],
            "status": "active",
            "tags": null,
            "urn": "do:droplet:234405355",
            "user_data": null,
            "vcpus": 1,
            "volume_ids": [],
            "vpc_uuid": "dbd7e3b0-6628-4e50-b8a3-fb90ccf9bd77"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main"
          ]
        }
      ]
    },
    {
      "module": "module.swap",
      "mode": "managed",
      "type": "null_resource",
      "name": "swap",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "3047129894646005677",
            "triggers": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "id": "7388933072497915792",
            "triggers": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "id": "5928345671134111684",
            "triggers": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host"
          ]
        }
      ]
    },
    {
      "module": "module.wireguard",
      "mode": "data",
      "type": "external",
      "name": "keys",
      "provider": "provider[\"registry.terraform.io/hashicorp/external\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "sh",
              "security/wireguard/scripts/gen_keys.sh"
            ],
            "query": null,
            "result": {
              "private_key": "uMJD6TTV0vQ7OO1R9OmADvCeL+PLCq4o6lZUy+Z13Vs=",
              "public_key": "LEqFMzfqmZxAcpCgGE8xRcLElcpBELl57UPjgH/gwSk="
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "sh",
              "security/wireguard/scripts/gen_keys.sh"
            ],
            "query": null,
            "result": {
              "private_key": "0Im0cdqZ92uZ4d9EV/fLp3rj4XMxFU5WuO+U725PoUs=",
              "public_key": "vMJ6hp7xtcZCrTeZiE/xvOidyxghsJNlsJ/ANgVxwVY="
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "sh",
              "security/wireguard/scripts/gen_keys.sh"
            ],
            "query": null,
            "result": {
              "private_key": "iOlA3V2zh4HKgMjzReBvtiJdmbJMTr+cCp2rYPoKNH0=",
              "public_key": "YYVPWrweRccDbhWdNvHQKcvvDREUDYA9BPYCqmBXEG8="
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.wireguard",
      "mode": "data",
      "type": "template_file",
      "name": "interface-conf",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "5afd796e03b6dc9ec65db226b5753aba8761a5c02e043d38d83fecebe9af4fe4",
            "rendered": "\n[Interface]\nAddress = 10.0.1.1\nPrivateKey = uMJD6TTV0vQ7OO1R9OmADvCeL+PLCq4o6lZUy+Z13Vs=\nListenPort = 51820\n\n\n[Peer]\nPublicKey = vMJ6hp7xtcZCrTeZiE/xvOidyxghsJNlsJ/ANgVxwVY=\nAllowedIps = 10.0.1.2/32\nEndpoint = 10.114.0.2:51820\n[Peer]\nPublicKey = YYVPWrweRccDbhWdNvHQKcvvDREUDYA9BPYCqmBXEG8=\nAllowedIps = 10.0.1.3/32\nEndpoint = 10.114.0.4:51820",
            "template": "\n[Interface]\nAddress = ${address}\nPrivateKey = ${private_key}\nListenPort = ${port}\n\n${peers}",
            "vars": {
              "address": "10.0.1.1",
              "peers": "\n[Peer]\nPublicKey = vMJ6hp7xtcZCrTeZiE/xvOidyxghsJNlsJ/ANgVxwVY=\nAllowedIps = 10.0.1.2/32\nEndpoint = 10.114.0.2:51820\n[Peer]\nPublicKey = YYVPWrweRccDbhWdNvHQKcvvDREUDYA9BPYCqmBXEG8=\nAllowedIps = 10.0.1.3/32\nEndpoint = 10.114.0.4:51820",
              "port": "51820",
              "private_key": "uMJD6TTV0vQ7OO1R9OmADvCeL+PLCq4o6lZUy+Z13Vs="
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "0b8428a7df72673efad73eb5709b7a5b3da0c57c96fc19d6260f7de65014d48f",
            "rendered": "\n[Interface]\nAddress = 10.0.1.2\nPrivateKey = 0Im0cdqZ92uZ4d9EV/fLp3rj4XMxFU5WuO+U725PoUs=\nListenPort = 51820\n\n[Peer]\nPublicKey = LEqFMzfqmZxAcpCgGE8xRcLElcpBELl57UPjgH/gwSk=\nAllowedIps = 10.0.1.1/32\nEndpoint = 10.114.0.3:51820\n\n[Peer]\nPublicKey = YYVPWrweRccDbhWdNvHQKcvvDREUDYA9BPYCqmBXEG8=\nAllowedIps = 10.0.1.3/32\nEndpoint = 10.114.0.4:51820",
            "template": "\n[Interface]\nAddress = ${address}\nPrivateKey = ${private_key}\nListenPort = ${port}\n\n${peers}",
            "vars": {
              "address": "10.0.1.2",
              "peers": "[Peer]\nPublicKey = LEqFMzfqmZxAcpCgGE8xRcLElcpBELl57UPjgH/gwSk=\nAllowedIps = 10.0.1.1/32\nEndpoint = 10.114.0.3:51820\n\n[Peer]\nPublicKey = YYVPWrweRccDbhWdNvHQKcvvDREUDYA9BPYCqmBXEG8=\nAllowedIps = 10.0.1.3/32\nEndpoint = 10.114.0.4:51820",
              "port": "51820",
              "private_key": "0Im0cdqZ92uZ4d9EV/fLp3rj4XMxFU5WuO+U725PoUs="
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "310c557911083070ffcd5e3a298f2b2436fe58ee90f628f4307dbe55629eeb1f",
            "rendered": "\n[Interface]\nAddress = 10.0.1.3\nPrivateKey = iOlA3V2zh4HKgMjzReBvtiJdmbJMTr+cCp2rYPoKNH0=\nListenPort = 51820\n\n[Peer]\nPublicKey = LEqFMzfqmZxAcpCgGE8xRcLElcpBELl57UPjgH/gwSk=\nAllowedIps = 10.0.1.1/32\nEndpoint = 10.114.0.3:51820\n[Peer]\nPublicKey = vMJ6hp7xtcZCrTeZiE/xvOidyxghsJNlsJ/ANgVxwVY=\nAllowedIps = 10.0.1.2/32\nEndpoint = 10.114.0.2:51820\n",
            "template": "\n[Interface]\nAddress = ${address}\nPrivateKey = ${private_key}\nListenPort = ${port}\n\n${peers}",
            "vars": {
              "address": "10.0.1.3",
              "peers": "[Peer]\nPublicKey = LEqFMzfqmZxAcpCgGE8xRcLElcpBELl57UPjgH/gwSk=\nAllowedIps = 10.0.1.1/32\nEndpoint = 10.114.0.3:51820\n[Peer]\nPublicKey = vMJ6hp7xtcZCrTeZiE/xvOidyxghsJNlsJ/ANgVxwVY=\nAllowedIps = 10.0.1.2/32\nEndpoint = 10.114.0.2:51820\n",
              "port": "51820",
              "private_key": "iOlA3V2zh4HKgMjzReBvtiJdmbJMTr+cCp2rYPoKNH0="
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.wireguard",
      "mode": "data",
      "type": "template_file",
      "name": "overlay-route-service",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "cee59fd9bb4d504de283d877321619e679f16248cb810c3128cefdcb924cdc69",
            "rendered": "[Unit]\nDescription=Overlay network route for Wireguard\nAfter=wg-quick@wg0.service\n\n[Service]\nType=oneshot\nUser=root\nExecStart=/sbin/ip route add 10.96.0.0/16 dev wg0 src 10.0.1.1\n\n[Install]\nWantedBy=multi-user.target",
            "template": "[Unit]\nDescription=Overlay network route for Wireguard\nAfter=wg-quick@wg0.service\n\n[Service]\nType=oneshot\nUser=root\nExecStart=/sbin/ip route add ${overlay_cidr} dev wg0 src ${address}\n\n[Install]\nWantedBy=multi-user.target",
            "vars": {
              "address": "10.0.1.1",
              "overlay_cidr": "10.96.0.0/16"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "9a76b3b04a3ecc2f37912900b9016bc705865571d981285b6eb7f58cf6dffe47",
            "rendered": "[Unit]\nDescription=Overlay network route for Wireguard\nAfter=wg-quick@wg0.service\n\n[Service]\nType=oneshot\nUser=root\nExecStart=/sbin/ip route add 10.96.0.0/16 dev wg0 src 10.0.1.2\n\n[Install]\nWantedBy=multi-user.target",
            "template": "[Unit]\nDescription=Overlay network route for Wireguard\nAfter=wg-quick@wg0.service\n\n[Service]\nType=oneshot\nUser=root\nExecStart=/sbin/ip route add ${overlay_cidr} dev wg0 src ${address}\n\n[Install]\nWantedBy=multi-user.target",
            "vars": {
              "address": "10.0.1.2",
              "overlay_cidr": "10.96.0.0/16"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "13c1395d602ef91edec5aea4b28d7583395eb4d837934df70e084815de1125d3",
            "rendered": "[Unit]\nDescription=Overlay network route for Wireguard\nAfter=wg-quick@wg0.service\n\n[Service]\nType=oneshot\nUser=root\nExecStart=/sbin/ip route add 10.96.0.0/16 dev wg0 src 10.0.1.3\n\n[Install]\nWantedBy=multi-user.target",
            "template": "[Unit]\nDescription=Overlay network route for Wireguard\nAfter=wg-quick@wg0.service\n\n[Service]\nType=oneshot\nUser=root\nExecStart=/sbin/ip route add ${overlay_cidr} dev wg0 src ${address}\n\n[Install]\nWantedBy=multi-user.target",
            "vars": {
              "address": "10.0.1.3",
              "overlay_cidr": "10.96.0.0/16"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.wireguard",
      "mode": "data",
      "type": "template_file",
      "name": "peer-conf",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "bebcca65123b453e781abe057bc9e40abf110312f27f8ffa1f9b5aedb86ae901",
            "rendered": "[Peer]\nPublicKey = LEqFMzfqmZxAcpCgGE8xRcLElcpBELl57UPjgH/gwSk=\nAllowedIps = 10.0.1.1/32\nEndpoint = 10.114.0.3:51820",
            "template": "[Peer]\nPublicKey = ${public_key}\nAllowedIps = ${allowed_ips}\nEndpoint = ${endpoint}:${port}",
            "vars": {
              "allowed_ips": "10.0.1.1/32",
              "endpoint": "10.114.0.3",
              "port": "51820",
              "public_key": "LEqFMzfqmZxAcpCgGE8xRcLElcpBELl57UPjgH/gwSk="
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "d6f35c9a0d0f2a6b3643f2b7eac48ec21426dcbb56f9ee8b4df5e2f51d6db01e",
            "rendered": "[Peer]\nPublicKey = vMJ6hp7xtcZCrTeZiE/xvOidyxghsJNlsJ/ANgVxwVY=\nAllowedIps = 10.0.1.2/32\nEndpoint = 10.114.0.2:51820",
            "template": "[Peer]\nPublicKey = ${public_key}\nAllowedIps = ${allowed_ips}\nEndpoint = ${endpoint}:${port}",
            "vars": {
              "allowed_ips": "10.0.1.2/32",
              "endpoint": "10.114.0.2",
              "port": "51820",
              "public_key": "vMJ6hp7xtcZCrTeZiE/xvOidyxghsJNlsJ/ANgVxwVY="
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "b0554955306be50f0e0099f1cd8d0643eeb85f21f0289a4fa1af1d82c33b4e8c",
            "rendered": "[Peer]\nPublicKey = YYVPWrweRccDbhWdNvHQKcvvDREUDYA9BPYCqmBXEG8=\nAllowedIps = 10.0.1.3/32\nEndpoint = 10.114.0.4:51820",
            "template": "[Peer]\nPublicKey = ${public_key}\nAllowedIps = ${allowed_ips}\nEndpoint = ${endpoint}:${port}",
            "vars": {
              "allowed_ips": "10.0.1.3/32",
              "endpoint": "10.114.0.4",
              "port": "51820",
              "public_key": "YYVPWrweRccDbhWdNvHQKcvvDREUDYA9BPYCqmBXEG8="
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.wireguard",
      "mode": "data",
      "type": "template_file",
      "name": "vpn_ips",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "d66e6eaf9400d27199898fa7ad38c5b0c2b6fac859bbada46433ce972b7ead71",
            "rendered": "10.0.1.1",
            "template": "${ip}",
            "vars": {
              "ip": "10.0.1.1"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "6000126d97ef042bc71ce21457cfb091f9e6c52fddad4c93d15c86ca8acaea62",
            "rendered": "10.0.1.2",
            "template": "${ip}",
            "vars": {
              "ip": "10.0.1.2"
            }
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "49a55e4b170820a6e24fedb790597d0f3b9c974d6b1f932025e06009924f4869",
            "rendered": "10.0.1.3",
            "template": "${ip}",
            "vars": {
              "ip": "10.0.1.3"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.wireguard",
      "mode": "managed",
      "type": "null_resource",
      "name": "wireguard",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "id": "2311992721116135474",
            "triggers": {
              "count": "3"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host",
            "module.wireguard.data.external.keys",
            "module.wireguard.data.template_file.interface-conf",
            "module.wireguard.data.template_file.overlay-route-service",
            "module.wireguard.data.template_file.peer-conf",
            "module.wireguard.data.template_file.vpn_ips"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "id": "6738953829244651743",
            "triggers": {
              "count": "3"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host",
            "module.wireguard.data.external.keys",
            "module.wireguard.data.template_file.interface-conf",
            "module.wireguard.data.template_file.overlay-route-service",
            "module.wireguard.data.template_file.peer-conf",
            "module.wireguard.data.template_file.vpn_ips"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "id": "2209881217084112145",
            "triggers": {
              "count": "3"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.provider.data.digitalocean_ssh_key.main",
            "module.provider.digitalocean_droplet.host",
            "module.wireguard.data.external.keys",
            "module.wireguard.data.template_file.interface-conf",
            "module.wireguard.data.template_file.overlay-route-service",
            "module.wireguard.data.template_file.peer-conf",
            "module.wireguard.data.template_file.vpn_ips"
          ]
        }
      ]
    }
  ]
}
